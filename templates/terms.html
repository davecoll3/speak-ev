{% extends "base.html" %}
{% block content %}
    <!-- main heading card -->
    <div class="container hero-container center-align">
        <img class="responsive-img" src="/static/images/leaf.jpg">
        <div class="text-block">
            <h1>Do You Speak EV?</h1>
            <p>Jargon busting explanations for common electric vehicle terms.</p>
            <a href="{{ url_for('sign_up') }}">Sign-up if you have something to add.</a>
        </div>
    </div>
    <!-- main heading card end -->

    <!-- search bar -->
    <div class="col card-panel search-panel">
        <form action="{{ url_for('search') }}" method="post" class="col s12">
            <!-- search input -->
            <div class="search-input input-field col s12 m12">
                <i class="fa-solid fa-search prefix grey-text text-darken-4"></i>
                <input type="text" name="query" id="query" minlength="2" class="validate" required>
                <label for="query">Search</label>
            </div>
            <!-- search input end -->
    
            <!-- search & reset buttons -->
            <div class="col s12 center-align">
                <button type="submit" class="btn btn-green waves-effect"> Search</button>
                <a href="{{ url_for('get_terms') }}" class="btn btn-grey">Reset</a>
            </div>
            <!-- search & reset buttons end -->
        </form>
    </div>
    <!-- search bar end -->
    
    {% if terms|length > 0 %}
        <!-- dictionary terms collapsible -->
        <ul class="collapsible popout">
            {% for term in terms %}
            <li>
                <!-- term name header -->
                <div class="collapsible-header black light-green-text text-accent-3">
                    <i class="fa-solid fa-bolt"></i></i>
                    <strong>{{ term.term_name }}</strong>
                </div>
                <!-- alternative name & definition -->
                <div class="collapsible-body grey darken-4 grey-text text-lighten-5">
                    <strong>{{ term.alternative_name }}</strong>
                    <p>{{ term.term_definition }}</p>
                    <p>
                        <em>Posted by: {{ term.created_by }}<br>
                        Last update on: {{ term.created_on }}</em>
                    </p>
                    <div class="center-align">
                        <!-- restricts edit and delete buttons to admins and terms created by the session user -->
                        {% if session.user|lower == "admin"|lower or session.user|lower == term.created_by|lower %}
                            <!-- edit & delete buttons -->
                            <a href="{{ url_for('edit_term', term_id=term._id) }}" 
                            class="waves-effect waves-light btn-small btn-green">
                                Edit <i class="fas fa-plug-circle-bolt right"></i>
                            </a>
                            <a href="#modal-{{ term._id }}"
                            class="btn-small btn-red modal-trigger waves-effect">
                                Delete <i class="fas fa-plug-circle-xmark right"></i>
                            </a>
                            <!-- edit & delete buttons end -->

                            <!-- delete term modal -->
                            <div id="modal-{{ term._id }}" class="modal">
                                <div class="modal-content grey-text text-darken-4">
                                    <h2>Are you sure you want to delete this Term?</h2>
                                    <p>WARNING! This action cannot be undone.</p>
                                </div>
                                <div class="modal-footer">
                                    <a href="#!" class="modal-close btn btn-green">
                                        Cancel <i class="fas fa-plug-circle-minus right"></i>
                                    </a>
                                    <a href="{{ url_for('delete_term', term_id=term._id) }}" class="btn btn-red">
                                        Delete <i class="fas fa-plug-circle-xmark right"></i>
                                    </a>
                                </div>
                            </div>
                            <!-- delete term modal end -->
                        {% endif %}
                    </div>
                </div>
            </li>
            {% endfor %} 
        </ul>
        <!-- dictionary terms collapsible end -->
    {% else %}
        <!-- no results message -->
        <div class="center-align light-green accent-1">
            <p>No Results Found</p>
        </div>
        <!-- no results message end -->
    {% endif %}
    
{% endblock %}